
<!DOCTYPE html>
<html>


<head>

  <link href="https://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>A multi-species, age-structured model for forest disease</title>
  <link rel="canonical" href="/archives/2012-11-28-lab-meeting-presentation-outline/" />

  
  <link rel="stylesheet" href="/assets/css/kube.css" />
  <link rel="stylesheet" href="/assets/css/custom.css" />
  <link rel="stylesheet" href="/assets/css/tufte.css" />

  
  <link href='https://fonts.googleapis.com/css?family=Alegreya:400italic,400,700,700italic&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Alegreya+SC:400&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
  <link href="https://fonts.googleapis.com/css?family=IM+Fell+English:400,400i&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=IM+Fell+English+SC&display=swap" rel="stylesheet">
  <link href="/assets/fonts/fell-flowers/style.css" rel="stylesheet" type="text/css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hack-font@3/build/web/hack-subset.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.0/css/academicons.min.css">
  <link href="/assets/fonts/fontawesome/css/all.css" rel="stylesheet">
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png">
  <link rel="shortcut icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png">
  <link rel="manifest" href="/assets/site.webmanifest">
  <link rel="mask-icon" href="/assets/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#2b5797">
  <meta name="theme-color" content="#ffffff">

  
  

  
  <meta name="description" content="This is a description of the model I&#39;ve implemented in the [SODDr
package](http://www.noamross.net/blog/2012/11/16/sod-dynamics-1.html),
which I prepared for a presentation for the Hastings lab meeting on
November 29, 2012.

Background
----------

[Sudden Oak Death](http://en.wikipedia.org/wiki/Sudden_oak_death) (SOD)
is a disease that threatens tanoak populations in California. It&#39;s cause
is an introduced pathogen, *Phytophthora ramorum*. *Phytophthora* is a
water mold that spreads by wind-blown rain and fog as well as through
" />

  <meta name="twitter:card" content="summary">
  <meta name="twitter:url" content="/archives/2012-11-28-lab-meeting-presentation-outline/">
  <meta name="twitter:title" content="A multi-species, age-structured model for forest disease">
  <meta name="twitter:description" content="This is a description of the model I&#39;ve implemented in the [SODDr
package](http://www.noamross.net/blog/2012/11/16/sod-dynamics-1.html),
which I prepared for a presentation for the Hastings lab meeting on
November 29, 2012.

Background
----------

[Sudden Oak Death](http://en.wikipedia.org/wiki/Sudden_oak_death) (SOD)
is a disease that threatens tanoak populations in California. It&#39;s cause
is an introduced pathogen, *Phytophthora ramorum*. *Phytophthora* is a
water mold that spreads by wind-blown rain and fog as well as through">
  <meta name="twitter:image" content="/assets/img/nr.png">
  <meta name="twitter:site" content="trang1618.github.io">
  <meta name="twitter:creator" content="@trang1618">

  <meta property="og:title" content="A multi-species, age-structured model for forest disease" />
  <meta property="og:locale" content="en_US" />
  <meta property="og:site_name" content="trang1618.github.io" />
  <meta property="og:description" content="  This is a description of the model I&#39;ve implemented in the [SODDr
package](http://www.noamross.net/blog/2012/11/16/sod-dynamics-1.html),
which I prepared for a presentation for the Hastings lab meeting on
November 29, 2012.

Background
----------

[Sudden Oak Death](http://en.wikipedia.org/wiki/Sudden_oak_death) (SOD)
is a disease that threatens tanoak populations in California. It&#39;s cause
is an introduced pathogen, *Phytophthora ramorum*. *Phytophthora* is a
water mold that spreads by wind-blown rain and fog as well as through" />
  <meta property="og:url" content="/archives/2012-11-28-lab-meeting-presentation-outline/" />
  <script type="application/ld+json">
    {"@type":"WebSite","url":"\/archives\/2012-11-28-lab-meeting-presentation-outline\/","headline":"A multi-species, age-structured model for forest disease", "name":"trang1618.github.io","description":"This is a description of the model I\x27ve implemented in the [SODDr\npackage](http:\/\/www.noamross.net\/blog\/2012\/11\/16\/sod-dynamics-1.html),\nwhich I prepared for a presentation for the Hastings lab meeting on\nNovember 29, 2012.\n\nBackground\n----------\n\n[Sudden Oak Death](http:\/\/en.wikipedia.org\/wiki\/Sudden_oak_death) (SOD)\nis a disease that threatens tanoak populations in California. It\x27s cause\nis an introduced pathogen, *Phytophthora ramorum*. *Phytophthora* is a\nwater mold that spreads by wind-blown rain and fog as well as through","@context":"http://schema.org"}
  </script>

  
  
</head>

<body>

<div id="topbar" class="is-hidden-print">
	<div class="wrapper">
		<header>
			<div class="is-navbar-container">
				<nav>
				<div class="is-brand">
					<a href="/">t  r  a  n  g </a>
					<a href="#"
						 class="is-push-right-mobile is-shown-mobile icon-kube-menu"
						 data-kube="toggle"
						 data-target="#navbar-main"></a>
				</div>
				</nav>
				<div id="navbar-main" class="is-navbar is-hidden-mobile is-center-mobile">
					<nav>
						<ul>
							<li><a href="/blog">blog</a></li>
						
							<li><a href="/vitae">vitae</a></li>
							<li><a href="#connect">connect</a></li>
						</ul>
					</nav>
				</div>
			</div>
		</header>
	</div>
</div>


<div class="wrapper">
  <div class="is-row is-stack-20">
    <div class="is-col is-10">&nbsp;</div>
    <div class="is-col is-60">
    <h1 class="is-text-center"><a href="">A multi-species, age-structured model for forest disease</a></h1>
    <h4 class="is-bigger is-text-center">November 28, 2012</h4>
    </div>
    <div class="is-col is-30">&nbsp;</div>
  </div>
  <div class="is-row is-stack-20">
  </div>
  <div class="is-row is-stack-20">
    <div class="is-col is-10 dateblock is-stack-20">
    </div>
    <div class="is-col is-60">
      <div class="story">
       


This is a description of the model I've implemented in the [SODDr
package](http://www.noamross.net/blog/2012/11/16/sod-dynamics-1.html),
which I prepared for a presentation for the Hastings lab meeting on
November 29, 2012.

Background
----------

[Sudden Oak Death](http://en.wikipedia.org/wiki/Sudden_oak_death) (SOD)
is a disease that threatens tanoak populations in California. It's cause
is an introduced pathogen, *Phytophthora ramorum*. *Phytophthora* is a
water mold that spreads by wind-blown rain and fog as well as through
human transport (e.g., transportation of plants). The disease has a wide
host range. Mortality and transmissivity vary considerably by species.

In Northern California, SOD threatens populations of tanoak
(*Notholithocarpus densiflorus*) and causes a long-term shift in species
composition in Redwood-Bay-Tanoak forests (Metz et al. 2012). SOD causes
high mortality in tanoak, with greater mortality in older, larger trees.
It does not kill Bay Laurel or Redwood, but can reside in both. Bay
Laurel has high transmissivity of the disease, because it broadcasts
large numbers of spores from its leaves, while infected Redwoods
transmit very few spores, and infected tanoaks produce a moderate amount
that emerge from its bark.

Model framework
---------------

Here I describe my version of a model from Cobb et al. (2012), which
simulates stand population dynamics and spread of the disease through a
stand. The goal of creating and extending this model is to provide a
framework to examine different treatment options to conserve tanoak,
primarily by manipulating species composition and density.

The model is a discrete implementation of the continuous model described
in Cobb et al. (2012). I moved to a discrete frame work in order to

1.  Make it easier to include stochasticity
2.  Fit the model to data using a hidden-Markov framework (Gimenez et
    al. 2012)

In addition, the model framework is designed so as to easily manipulate
the species/size classes. This will allow me to simplify the structure
to explore theoretical model behavior, and generate a nested set of
models to fit to data.

The model has the following attributes

-   **Spatially explicit:** Each cell on a lattice can contain trees of
    any species
-   **Multi-species:** Each tree species has different parameters for
    growth and interaction with the disease
-   **Age structured:** Individual trees advance through size classes
    which have different parameters
-   **SI-based:** Trees may belong to a susceptible or infected class,
    which modifies growth and mortality parameters.

Structure
---------

The population at time $t$ and location $x$ is $\boldsymbol N_{t,x}$,
which is a vector that collapses species, size , and disease categories
("classes"). Thus, for two species, each with two size categories, we
have vector of eight classes at one point in space at time:

$$\boldsymbol N_{t,x} = \begin{bmatrix}
a_{1,S} \\
a_{1,I} \\
a_{2,S} \\
a_{2,I} \\
b_{1,S} \\
b_{1,I} \\
b_{2,S} \\
b_{2,I} \end{bmatrix}$$

Demographic parameters vary these classes, so each demographic and
epidemiological parameter is a vector. Here are the class-specific
parameters:

  --------------------------------------------------------------------
  Parameter Vector Symbol       Description
  ----------------------------- --------------------------------------
  $\boldsymbol m$               Probability of death per year. Varies
                                by species, size, and disease status.

  $\boldsymbol b$               Fecundity per individual per year.
                                Varies by species and size.

  $\boldsymbol g$               Probability of transition to the next
                                size class. Varies by species and
                                size.

  $\boldsymbol R'$              Probability of recovery from disease.
                                Varies by species.

  $\boldsymbol r$               Probability of resprouting after death
                                by disease. Varies by species.

  $\boldsymbol w$               Relative space taken up by an
                                individual tree of the class. Varies
                                by species and size.
  --------------------------------------------------------------------

Individuals do not transition between species, but they transition
between size classes according to $g$.

Individuals transition from $S$ to $I$ class at the rate of
$\boldsymbol \Lambda$, the class-specific force of infection. $\Lambda$
on each class depends on both the burden of spores arriving in the cell
and the class's susceptibility to those spores. Spores arriving in the
cell are calculated by summing the dispersal of spores for each infected
class in the lattice, to get a vector of spore burden from each class
for a location. This is multiplied by a "Who Acquires Infection From
Whom" matrix (WAIFW, Anderson and May (1985)) to get
$\boldsymbol \Lambda$.

$$\boldsymbol \Lambda_{t,x} = \phi (\boldsymbol N_t, x, \boldsymbol\theta) \boldsymbol W$$

$\phi$ is the dispersal kernel for spores from all trees to location
$x$, and $\boldsymbol\theta$ is the vector of dispersal parameters for
each class of tree. $\boldsymbol W$ is the WAIFW matrix, which
represents differing physiological susceptibility to disease as well as
the vertical dispersal of spores. Vertical structure of the stand is
important, as small trees being rained down upon with spores from
infected tall trees are more likely to be infected than the other way
around.

Trees transition from $I$ to $S$ by recovery at rate $\boldsymbol R_t$.
Note that $\boldsymbol R_t$ is actually the base probability of recovery
mutliplied by the probability of escaping infection until the next year:

$$R_{t} = (1-\Lambda_t) \times R'$$

Both $S$ and $I$ individuals are removed from the population via
mortality. For some species (e.g., tanoak), this occurs at a higher rate
in infected individuals

Recruitment of new individuals is density-dependent, based on shading.
New recruits in the first age class sprout at a rate equal to the
fecundity and population of their species in the cell, times the amount
of empty space $(E_x)$ for growth:

$$E_{x,t} = 1 - \sum_i w_i N_{x,t,i}$$

In addition, a tree may resprout upon death, usually when killed by
disease. This occurs with probability $\boldsymbol r$.

With $\Lambda, R$ and $E$ calculated at each time step, we can create
the transition matrix $\boldsymbol L$ at time $t$

$$\boldsymbol L_t = 
\begin{bmatrix}
    (1-\Lambda_{1,t})(1-g_1-m_1) + b_1 E_t + r_1 m_1 & R_{2,t} (1-g_2-m_2) + b_2 E_t + r_2 m_2 & 0 & 0 & 0 & 0 & 0 & 0 \\
    \Lambda_{1,t} (1-g_1-m_1) & (1-R_{2,t})(1-g_2-m_2) & 0 & 0 & 0 & 0 & 0 & 0 \\
    (1-\Lambda_{1,t})g_1 & R_{2,t} g_2 & (1-\Lambda_{3,t})(1-g_3-m_3) & R_{4,t} (1-g_4-m_4) & 0 & 0 & 0 & 0 \\
    \Lambda_{1,t} g_1 & (1-R_{2,t})g_2 & \Lambda_{3,t} (1-g_3-m_3) & (1-R_{4,t})(1-g_4-m_4) & 0 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 & (1-\Lambda_{5,t})(1-g_5-m_5) + b_5E + r_5m_5 & R_{6,t} (1-g_6-m_6) + b_6E_t + r_6m_6 & 0 & 0 \\
    0 & 0 & 0 & 0 & \Lambda_{5,t} (1-g_5-m_5) & (1-R_{6,t})(1-g_6-m_6) & 0 & 0 \\
    0 & 0 & 0 & 0 & (1-\Lambda_{5,t})g_5 & R_{6,t}g_6 & (1-\Lambda_{7,t})(1-g_7-m_7) & R_{8,t} (1-g_8-m_8) \\
    0 & 0 & 0 & 0 & \Lambda_{5,t} g_5 & (1-R_{6,t})g_6 & \Lambda_{7,t} (1-g_7-m_7) & (1-R_{8,t})(1-g_8-m_8) 
\end{bmatrix}
$$

Parameterization
----------------

As implemented in Cobb et al. (2012), the model is parameterized as
follows:

-   3 Species
    -   **Tanoak** - This is the species of concern. The disease causes
        mortality and it is only a moderate spreader. This species has 4
        size classes. Mortality is lowest for middle size classes, but
        in infected trees an order of magnitude greater and greatest in
        the largest size classes. Fecundity increases with age.
        Resprouting 50% when killed by disease, zero otherwise.
    -   **Bay Laurel** - Litte affected by the disease, but when
        infected produces many spores. Only one age class.
    -   **Redwood** - Only one age class. Does not interact with the
        disease. Only interacts with other species via density
        competition.

-   Dispersal to adjacent cells
    -   50% of spores stay in cell of origin, 12.5% land in each of 8
        adjacent cells

-   Fecundities and space parameters were adjusted so as to achieve a
    steady state at compositions matching field measurements.
-   20 $\times$ 20 lattice
-   Disease introduced to all individuals in a center cell.

Results
-------

Here are the outputs of the model (as shown in my [last
post](www.noamross.net/blog/2012/11/16/sod-dynamics-1.html)). They show
the population of tanoak as a fraction of the total species composition,
broken up into the two largest and two smallest size classes.

First, here's the model at steady state without any disease:

![Tanoak as a fraction of total population over time, no
disease](/assets/old-blog-stuff/tanoakdyn1/papeplot.png)

Here I introduce disease to one cell:

![Tanoak as a fraction of total population, using baseline initial
conditions and introducing
disease](/assets/old-blog-stuff/tanoakdyn1/disease1.png)

Here, the initial population is only tanoaks and redwoods, with mostly
tanoaks, and disease is introduced.

![Tanoak dynamics under the "Mostly Tanoak, Some Redwood"
scenario](/assets/old-blog-stuff/tanoakdyn1/disease2.png)

Here, the initial population is mostly redwoods, with some tanoak, and
disease is introduced. No outbreak occurs:

![Tanoak dynamics under the "Some Tanoak, Mostly Redwood"
scenario](/assets/old-blog-stuff/tanoakdyn1/disease3.png)

These are pretty similar to the outputs from the Cobb et al. (2012)
model. The main difference are the overall rates, which makes sense
becauase I didn't adjust the parameters for the change from continuous
to discrete time:

![Figure 4 from Cobb et al.
(2012)](/assets/old-blog-stuff/cobb2012plots.png)

Next steps
----------

Now that I have the model replicated and working, I have a few tasks:

-   Examine the bifurcation between stable and collapsing populations
    under the two-species scenario
-   Do the same for three-species mixes
-   Add demographic stochasticity, primarily
    -   *Hypothesis* - there's a best density of trees for preventing
        collapse, that balances the risk of stochastic loss from small
        populations and risk of disease outbreak from big ones.

-   Test robustness of results under more dispersal kernels, and
    heterogenous distribution of trees (clustering, etc.)
-   Add an external spore source

Some areas of concern
---------------------

-   **Density Dependence:** The current form of density-dependence only
    accounts for competition at recruitment. It's also unstable, causing
    *negative* recruitment in some cases. Unsure how to represent this
    better without too much complication

    -   On a related note, the current "space" allocation of the trees
        implies that there's greater suppression of new seedlings by the
        smallest and largest age classes than the middle age classes.
        Does this make sense?

Things to research
------------------

-   Alternative distribution kernels (Chesson and Lee 2005)
-   Tanoak-conifer competition literature and potential alternative
    models
-   Tanoak recruitment distributions

Notes from Lab Meeting
----------------------

Lee et al. (2001) discuss the importance of the thickness of tails
Thickness of tail affects rate of spread, but for population dynamic
questions often are less important. Dispersnal kernels might not matter
much.

Using a simple zero/one switch for $E$ could eliminate the artifact of
negative recruitment.

Papers by Mark Lewis and Steve Pacala on spread of a population might be
relevant here.

References
----------

Anderson, R. M., and R. M. May. 1985. Age-related changes in the rate of
disease transmission: implications for the design of vaccination
programmes. J. Hyg. Camb.

Chesson, P., and C. T. Lee. 2005. Families of discrete kernels for
modeling dispersal.. Theoretical population biology 67:241–56.

Cobb, R. C., J. A. N. Filipe, R. K. Meentemeyer, C. A. Gilligan, and D.
M. Rizzo. 2012. Ecosystem transformation by emerging infectious disease:
loss of large tanoak from California forests. Journal of Ecology.

Gimenez, O., J. D. Lebreton, J. M. Gaillard, R. Choquet, and R. Pradel.
2012. Estimating demographic parameters using hidden process dynamic
models. Theoretical Population Biology 82:307–316.

Lee, C. T., M. F. Hoopes, J. Diehl, W. Gilliland, G. Huxel, E. V.
Leaver, K. McCann, J. Umbanhowar, and A. Mogilner. 2001. Non-local
concepts and models in biology.. Journal of theoretical biology
210:201–19.

Metz, M. R., K. M. Frangioso, A. C. Wickland, R. K. Meentemeyer, and D.
M. Rizzo. 2012. An emergent disease causes directional changes in forest
species composition in coastal California. Ecosphere 3:86.

      </div>
      <hr>
      
      <a href="/archives/2012-11-19-editing-csv-files-in-r/"> &larr;&nbsp;A quick function for editing CSV files in R</a> |
      
      <a href="//blog/#2012">All posts</a>
      
      | <a href="/archives/2012-11-30-lauren-yamane-on-matrix-population-models/">Lauren Yamane on Matrix Population Models in R&nbsp;&rarr;</a>
      
    </div>
    <div class="is-col is-30"></div>

  </div>
</div>



<footer id="footer" class="is-hidden-print">
  <div class="wrapper">
    <div class="is-row .is-small is-muted">
      <div class="is-col is-33">
        <h3>About</h3>
        <em>
          <p>This is my personal website. Nothing here is endorsed by my employer or organizations I am part of.</p>
          <p>Content on this site is released under a
            <a href="https://creativecommons.org/licenses/by/4.0/legalcode">CC-BY 4.0 license.</a>
            Source code of the site is provided under the <a href="https://opensource.org/licenses/MIT">MIT license</a>
            and may be reused without restriction.</p>
          <p>Huge thanks to Noam Ross for the beautifully designed website and detailed instruction on how to built it <a href="https://www.noamross.net/2019/08/09/a-new-website/">here</a>.</p>
        </em>
      </div>
      <div class="is-col is-33">
        <h3 id="connect">Connect</h3>
        <ul class="fa-ul">
          <li><i class="fa-li fas fa-briefcase fa-fw"></i>3700 Hamilton Walk, Philadelphia, PA 19104</li>
          <li><i class="fa-li fas fa-envelope fa-fw"></i><a href="mailto:grixor@gmail.com">grixor@gmail.com</a></li>
          <li><a href="https://orcid.org/0000-0003-3737-6565"><i class="fa-li ai ai-orcid"></i></a><a href="https://orcid.org/0000-0003-3737-6565">0000-0003-3737-6565</a></li>
          <li><a href="https://scholar.google.com/citations?user=OMpJVfsAAAAJ&hl=en"><i class="fa-li ai ai-google-scholar"></i></a><a href="https://scholar.google.com/citations?user=OMpJVfsAAAAJ">Google Scholar</a></li>
          <li><a href="https://twitter.com/trang1618"><i class="fa-li fab fa-twitter fa-fw"></i></a><a href="https://twitter.com/trang1618">@trang1618</a></li>
          <li><a href="https://github.com/trang1618"><i class="fa-li fab fa-github fa-fw"></i></a><a href="https://github.com/trang1618">github.com/trang1618</a>
          <li><a href="https://slides.com/trang1618"><i class="fa-li fas fa-object-ungroup fa-fw"></i></a><a href="https://slides.com/trang1618">slides.com/trang1618</a>
        </ul>
      </div>
      <div class="is-col is-33">
        <h3 id="subscribe">Subscribe</h3>
        <em><p>Follow me on Twitter at <a href="https://twitter.com/trang1618">@trang1618</a> where I'll update you if anything is posted.</p></em>
        <h3 id="search">Search</h3>
        <nav class="is-push-right is-left-mobile" class="is-hidden-mobile">
					<form method="get" action="https://duckduckgo.com/">
      <input type="search" name="q" maxlength="255" placeholder="Search on site">
      <input type="hidden" name="sites" value="www.trang1618.github.io" />
      <input type="hidden" name="ka" value="Alegreya" />
      <input type="hidden" name="k7" value="#faf8f8" />
      <input type="hidden" name="kj" value="#b33" />
      <input type="hidden" name="ky" value="#fafafa" />
      <input type="hidden" name="kx" value="b" />
      <input type="hidden" name="ko" value="-1" />
      <input type="hidden" name="k1" value="-1" />
      <input type="hidden" name="kt" value="Alegreya Sans" />
</form>
				</nav>
      </div>
    </div>
  </div>
</footer>

<script type="text/javascript" src="/assets/js/kube.js"></script>
<script>
  $K.dom(window).on('load', $K.init);
</script>


</body>
</html>
