
<!DOCTYPE html>
<html>


<head>

  <link href="https://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Some analytics: Does age structure matter for disease spread?</title>
  <link rel="canonical" href="/archives/2013-06-21-multi-infection-analytic/" />

  
  <link rel="stylesheet" href="/assets/css/kube.css" />
  <link rel="stylesheet" href="/assets/css/custom.css" />
  <link rel="stylesheet" href="/assets/css/tufte.css" />

  
  <link href='https://fonts.googleapis.com/css?family=Alegreya:400italic,400,700,700italic&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Alegreya+SC:400&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
  <link href="https://fonts.googleapis.com/css?family=IM+Fell+English:400,400i&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=IM+Fell+English+SC&display=swap" rel="stylesheet">
  <link href="/assets/fonts/fell-flowers/style.css" rel="stylesheet" type="text/css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hack-font@3/build/web/hack-subset.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.0/css/academicons.min.css">
  <link href="/assets/fonts/fontawesome/css/all.css" rel="stylesheet">
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png">
  <link rel="shortcut icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png">
  <link rel="manifest" href="/assets/site.webmanifest">
  <link rel="mask-icon" href="/assets/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#2b5797">
  <meta name="theme-color" content="#ffffff">

  
  

  
  <meta name="description" content="My [first crack at an age-structured disease model with multiple infections](http://www.noamross.net/blog/2013/6/11/multi-infection-tests.html) yielded the interesting result that one could observe differences in disease rates across age without any actual differences in the biology between old and young individuals. Today I&#39;m trying to answer a different question analytically: does age structure matter for the course of the disease in the whole population? Here&#39;s the model. There are two minor changes: I no longer scale $J$ and $A$ with $K$ in the third and fourth equations; there&#39;s no reason the encounter rate should be tied to carrying capacity.
" />

  <meta name="twitter:card" content="summary">
  <meta name="twitter:url" content="/archives/2013-06-21-multi-infection-analytic/">
  <meta name="twitter:title" content="Some analytics: Does age structure matter for disease spread?">
  <meta name="twitter:description" content="My [first crack at an age-structured disease model with multiple infections](http://www.noamross.net/blog/2013/6/11/multi-infection-tests.html) yielded the interesting result that one could observe differences in disease rates across age without any actual differences in the biology between old and young individuals. Today I&#39;m trying to answer a different question analytically: does age structure matter for the course of the disease in the whole population? Here&#39;s the model. There are two minor changes: I no longer scale $J$ and $A$ with $K$ in the third and fourth equations; there&#39;s no reason the encounter rate should be tied to carrying capacity.">
  <meta name="twitter:image" content="/assets/img/nr.png">
  <meta name="twitter:site" content="trang1618.github.io">
  <meta name="twitter:creator" content="@trang1618">

  <meta property="og:title" content="Some analytics: Does age structure matter for disease spread?" />
  <meta property="og:locale" content="en_US" />
  <meta property="og:site_name" content="trang1618.github.io" />
  <meta property="og:description" content="  My [first crack at an age-structured disease model with multiple infections](http://www.noamross.net/blog/2013/6/11/multi-infection-tests.html) yielded the interesting result that one could observe differences in disease rates across age without any actual differences in the biology between old and young individuals. Today I&#39;m trying to answer a different question analytically: does age structure matter for the course of the disease in the whole population? Here&#39;s the model. There are two minor changes: I no longer scale $J$ and $A$ with $K$ in the third and fourth equations; there&#39;s no reason the encounter rate should be tied to carrying capacity." />
  <meta property="og:url" content="/archives/2013-06-21-multi-infection-analytic/" />
  <script type="application/ld+json">
    {"@type":"WebSite","url":"\/archives\/2013-06-21-multi-infection-analytic\/","headline":"Some analytics: Does age structure matter for disease spread?", "name":"trang1618.github.io","description":"My [first crack at an age-structured disease model with multiple infections](http:\/\/www.noamross.net\/blog\/2013\/6\/11\/multi-infection-tests.html) yielded the interesting result that one could observe differences in disease rates across age without any actual differences in the biology between old and young individuals. Today I\x27m trying to answer a different question analytically: does age structure matter for the course of the disease in the whole population? Here\x27s the model. There are two minor changes: I no longer scale $J$ and $A$ with $K$ in the third and fourth equations; there\x27s no reason the encounter rate should be tied to carrying capacity.","@context":"http://schema.org"}
  </script>

  
  
</head>

<body>

<div id="topbar" class="is-hidden-print">
	<div class="wrapper">
		<header>
			<div class="is-navbar-container">
				<nav>
				<div class="is-brand">
					<a href="/">t  r  a  n  g </a>
					<a href="#"
						 class="is-push-right-mobile is-shown-mobile icon-kube-menu"
						 data-kube="toggle"
						 data-target="#navbar-main"></a>
				</div>
				</nav>
				<div id="navbar-main" class="is-navbar is-hidden-mobile is-center-mobile">
					<nav>
						<ul>
							<li><a href="/blog">blog</a></li>
						
							<li><a href="/vitae">vitae</a></li>
							<li><a href="#connect">connect</a></li>
						</ul>
					</nav>
				</div>
			</div>
		</header>
	</div>
</div>


<div class="wrapper">
  <div class="is-row is-stack-20">
    <div class="is-col is-10">&nbsp;</div>
    <div class="is-col is-60">
    <h1 class="is-text-center"><a href="">Some analytics: Does age structure matter for disease spread?</a></h1>
    <h4 class="is-bigger is-text-center">June 21, 2013</h4>
    </div>
    <div class="is-col is-30">&nbsp;</div>
  </div>
  <div class="is-row is-stack-20">
  </div>
  <div class="is-row is-stack-20">
    <div class="is-col is-10 dateblock is-stack-20">
    </div>
    <div class="is-col is-60">
      <div class="story">
       


My [first crack at an age-structured disease model with multiple
infections](http://www.noamross.net/blog/2013/6/11/multi-infection-tests.html)
yielded the interesting result that one could observe differences in
disease rates across age without any actual differences in the biology
between old and young individuals. Today I'm trying to answer a
different question analytically: does age structure matter for the
course of the disease in the whole population?

Here's the model. There are two minor changes: I no longer scale $J$ and
$A$ with $K$ in the third and fourth equations; there's no reason the
encounter rate should be tied to carrying capacity. Also, I've put
stage-specific values for all the parameters (now including $\alpha$,
$\mu$, and $\lambda$).

$$\begin{aligned}
  \frac{dJ}{dt}  &= A f_A \left(1 - \frac{J+A}{K} \right) + J  
                    \left(f_J \left(1 - \frac{J+A}{K} \right) - 
                          d_J - g\right) - \alpha_J P_J \\
  \frac{dA}{dt}  &= J g - A d_A - \alpha_A P_A \\
  \frac{dP_J}{dt}  &= \lambda_J J (P_J + P_A)  - 
                      P_J \left(d_J + \mu_J + g + \alpha_J 
                                \left(1 + \frac{P_J}{J} \right) \right) \\
  \frac{dP_A}{dt}  &= \lambda_A A (P_J + P_A)  + P_J  g - 
                      P_A \left(d_A + \mu_A + \alpha_A 
                                \left(1 + \frac{P_A}{A}  \right) \right)
\end{aligned}$$

To examine whether the age structure matters, I try to collapse this
down to a model of just one aggregated population. Let

$$\begin{aligned}
  N = J + A, && P = P_J + P_A
\end{aligned}$$

The parameters then become the population-weighted means of their
components:

$$\begin{aligned}
   d = (J d_J + A d_A)/N, && f = (J f_J + A d_A)/N \\
   \mu = (P_J \mu_J + P_A \mu_A)/P, && \alpha = (P_J \alpha_J + P_A \alpha_A)/P
\end{aligned}$$

The first two equations sum easily:

$$\frac{dN}{dt} = Nf\left(1 - \frac{N}{K}\right) - dN - \alpha P$$

The second two equations don't do quite the same thing:

$$\begin{aligned}
  \frac{dP}{dt} & = \lambda NP - \mu P - \left(d_J P_J + d_A P_A\right) - 
                     \alpha P - \left(\alpha_J \frac{P_J^2}{J} + 
                                       \alpha_A \frac{P_A^2}{A}\right) 
\end{aligned}$$

To compare this equation to a model with no age structure, I define two
terms, $\psi$ and $\phi$ which represent the differences between the
terms in parentheses in the equation above and the equivalent term in a
model without age structure. For ease of later calculations, I scale
these by $P$:

$$\begin{aligned}
    \psi P &= (d_J P_J + d_A P_A) - dP \\
           &= (d_J P_J + d_A P_A) - \frac{d_J J + d_A A}{J + A} (P_J + P_A) \\
           &= \frac{(d_J - d_A)P_J A + (d_A - d_J)P_A J}{J+A} \\
           &= \frac{(d_J - d_A)(P_J A - P_A J)}{J+A} 
  \end{aligned}$$

$$\begin{aligned}
    \phi P &= \left(\alpha_J \frac{P_J^2}{J} + \alpha_A \frac{P_A^2}{A}\right) - 
              \alpha \frac{P^2}{N}  \\
           &= \left(\alpha_J \frac{P_J^2}{J} + \alpha_A \frac{P_A^2}{A}\right) - 
              \frac{(\alpha_J P_J + \alpha_A P_A)(P_J + P_A)}{(J+A)} \\
           &=  \frac{(\alpha_J P_J A - \alpha_A P_A J)(P_J A - P_A J)}{JA(J+A)} 
  \end{aligned}$$

I substitute these into $\frac{dP}{dt}$ above to get

$$\frac{dP}{dt} = \lambda N P - (\mu + d) P - 
  \alpha P \left(1 + \frac{P}{N}\right) - (\psi + \phi)P$$

How to $\phi$ and $\psi$ modify the dynamics? $\psi$ is zero at
$d_A=d_J$ or $\frac{P_J}{J} = \frac{P_A}{A}$. It will be positive if the
class with higher infection rate also has a higher base mortality rate,
and negative otherwise. A positive $\psi$ value will decrease the growth
of the parasite population, as more-infected individuals will die at a
faster rate, removing more parasites from the population.

$\phi$ is zero at at $\frac{P_J}{J} = \frac{P_A}{A}$, but not at
$\alpha_J = \alpha_A$, meaning that dynamics should deviate from an a
model without age structure even if there is no difference in
disease-driven mortality between age classes. For $\phi$ to be positive
either both or neither of the terms in parenthesis must be greater than
zero, or

$$\left(\frac{P_J}{J} > \frac{P_A}{A}\right) \Leftrightarrow 
  \left(\alpha_J \frac{P_J}{J} > \alpha_A \frac{P_A}{A}\right)$$

Note that if $\alpha_J = \alpha_A$, this is always true. So if the
disease has an identical effect on both age classes, $\phi$ will be
positive. A positive value of $\phi$ will slow growth of the parasite
population by increasing the death rate of the more infected population,
more rapidly removing parasites. The reverse will happen when $\phi$ is
negative. The more infected population will lose fewer individuals to
disease because of a low relative $\alpha$ value, and the rate of
parasite growth will increase because these individuals will remain to
reproduce. Essentially, the value of $\phi$ represents whether the ratio
$\alpha_J/\alpha_A$ enhances or offsets the non-linear relationship
between parasite load and parasite loss caused by aggregation of
parasites.

Now the system of equations is:

$$
\begin{aligned}
  \frac{dN}{dt} &= Nf \left(1 - \frac{N}{K}\right) - dN - \alpha P \\
  \frac{dP}{dt} &= \lambda N P - (\mu + d) P - 
                   \alpha P \left(1 + \frac{P}{N}\right) - P(\psi + \phi) 
\end{aligned}
$$

Since all terms in $\psi$ and $\phi$ contain $P_X$ values in the
numerators but not denominators, as $P \rightarrow 0$, so do $\psi$ and
$\phi$. This means that the growth rate of the parasites is unaffected
by the population structure when numbers are small. We can calculate
this rate, which is the same as it would be with no population
structure:

$$\frac{dP/dt}{P}\bigg|_{P\rightarrow 0} = \lambda N - \mu - d - \alpha$$

$$N_{\text{threshold}} = \frac{\mu + d + \alpha}{\lambda}$$

(A reminder here that reducing $\alpha$ but not $\lambda$ in the tanoak
population is a losing strategy)

Setting $dN/dt = 0$, we can solve for $\frac{P}{N}$.

$$
  \frac{P}{N} = \frac{f\left(1-\frac{N}{K}\right) -d }{\alpha}
$$

Under disease-free conditions, this is easily solved for $N$:

$$N_{eq}\big|_{P=0} = {K\left(1-\frac{d}{f}\right)}$$

If the population was unstructured, we would get:

$$N_{eq}\big|_{P_{eq} > 0} = \frac{\mu + \alpha + f}{\lambda + \frac{f}{K} } $$

With the age structure, $$
\begin{aligned}
  \frac{dP}{dt} &= 0 = P\left(\lambda N - \mu - d - \alpha - 
                              \alpha \frac{P}{N}\right) -  P(\psi + \phi)\\
  N &= \frac{\mu + \alpha + f + \psi + \phi}{\lambda + \frac{f}{K}} 
\end{aligned} 
$$

Positive values of $\psi$ and $\phi$ increase the overall host
population, and following the expression for $P/N$ above, reduce the
mean infection level.

      </div>
      <hr>
      
      <a href="/archives/2013-06-18-helpconsoleexample/"> &larr;&nbsp;Printing R help files in the console or in knitr documents</a> |
      
      <a href="//blog/#2013">All posts</a>
      
      | <a href="/archives/2013-11-07-mbi-poster-post/">MBI Meeting Poster: Optimal Control of Forest Disease&nbsp;&rarr;</a>
      
    </div>
    <div class="is-col is-30"></div>

  </div>
</div>



<footer id="footer" class="is-hidden-print">
  <div class="wrapper">
    <div class="is-row .is-small is-muted">
      <div class="is-col is-33">
        <h3>About</h3>
        <em>
          <p>This is my personal website. Nothing here is endorsed by my employer or organizations I am part of.</p>
          <p>Content on this site is released under a
            <a href="https://creativecommons.org/licenses/by/4.0/legalcode">CC-BY 4.0 license.</a>
            Source code of the site is provided under the <a href="https://opensource.org/licenses/MIT">MIT license</a>
            and may be reused without restriction.</p>
          <p>Huge thanks to Noam Ross for the beautifully designed website and detailed instruction on how to built it <a href="https://www.noamross.net/2019/08/09/a-new-website/">here</a>.</p>
        </em>
      </div>
      <div class="is-col is-33">
        <h3 id="connect">Connect</h3>
        <ul class="fa-ul">
          <li><i class="fa-li fas fa-briefcase fa-fw"></i>3700 Hamilton Walk, Philadelphia, PA 19104</li>
          <li><i class="fa-li fas fa-envelope fa-fw"></i><a href="mailto:grixor@gmail.com">grixor@gmail.com</a></li>
          <li><a href="https://orcid.org/0000-0003-3737-6565"><i class="fa-li ai ai-orcid"></i></a><a href="https://orcid.org/0000-0003-3737-6565">0000-0003-3737-6565</a></li>
          <li><a href="https://scholar.google.com/citations?user=OMpJVfsAAAAJ&hl=en"><i class="fa-li ai ai-google-scholar"></i></a><a href="https://scholar.google.com/citations?user=OMpJVfsAAAAJ">Google Scholar</a></li>
          <li><a href="https://twitter.com/trang1618"><i class="fa-li fab fa-twitter fa-fw"></i></a><a href="https://twitter.com/trang1618">@trang1618</a></li>
          <li><a href="https://github.com/trang1618"><i class="fa-li fab fa-github fa-fw"></i></a><a href="https://github.com/trang1618">github.com/trang1618</a>
          <li><a href="https://slides.com/trang1618"><i class="fa-li fas fa-object-ungroup fa-fw"></i></a><a href="https://slides.com/trang1618">slides.com/trang1618</a>
        </ul>
      </div>
      <div class="is-col is-33">
        <h3 id="subscribe">Subscribe</h3>
        <em><p>Follow me on Twitter at <a href="https://twitter.com/trang1618">@trang1618</a> where I'll update you if anything is posted.</p></em>
        <h3 id="search">Search</h3>
        <nav class="is-push-right is-left-mobile" class="is-hidden-mobile">
					<form method="get" action="https://duckduckgo.com/">
      <input type="search" name="q" maxlength="255" placeholder="Search on site">
      <input type="hidden" name="sites" value="www.trang1618.github.io" />
      <input type="hidden" name="ka" value="Alegreya" />
      <input type="hidden" name="k7" value="#faf8f8" />
      <input type="hidden" name="kj" value="#b33" />
      <input type="hidden" name="ky" value="#fafafa" />
      <input type="hidden" name="kx" value="b" />
      <input type="hidden" name="ko" value="-1" />
      <input type="hidden" name="k1" value="-1" />
      <input type="hidden" name="kt" value="Alegreya Sans" />
</form>
				</nav>
      </div>
    </div>
  </div>
</footer>

<script type="text/javascript" src="/assets/js/kube.js"></script>
<script>
  $K.dom(window).on('load', $K.init);
</script>


</body>
</html>
