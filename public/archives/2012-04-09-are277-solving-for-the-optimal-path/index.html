
<!DOCTYPE html>
<html>


<head>

  <link href="https://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ARE277 - Solving for the Optimal Path</title>
  <link rel="canonical" href="/archives/2012-04-09-are277-solving-for-the-optimal-path/" />

  
  <link rel="stylesheet" href="/assets/css/kube.css" />
  <link rel="stylesheet" href="/assets/css/custom.css" />
  <link rel="stylesheet" href="/assets/css/tufte.css" />

  
  <link href='https://fonts.googleapis.com/css?family=Alegreya:400italic,400,700,700italic&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Alegreya+SC:400&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
  <link href="https://fonts.googleapis.com/css?family=IM+Fell+English:400,400i&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=IM+Fell+English+SC&display=swap" rel="stylesheet">
  <link href="/assets/fonts/fell-flowers/style.css" rel="stylesheet" type="text/css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hack-font@3/build/web/hack-subset.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.0/css/academicons.min.css">
  <link href="/assets/fonts/fontawesome/css/all.css" rel="stylesheet">
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png">
  <link rel="shortcut icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png">
  <link rel="manifest" href="/assets/site.webmanifest">
  <link rel="mask-icon" href="/assets/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#2b5797">
  <meta name="theme-color" content="#ffffff">

  
  

  
  <meta name="description" content="Thresholds / Critical Depensation in Population Dynamics -------------------------------------------------------- Mechanisms for critical depensation (Allee effect): - Mate-finding (example: Right Whales) - Demographic stochasticity (can be captured by a deterministic threshold if stochasticity is not explicit) $$\dot{X} = -r\left(1- \frac{X}{\tilde{K}}\right)\left(1- \frac{X}{K}\right)X$$ Here, $\tilde{K}$ is the threshold of zero growth. Optimal Control --------------- ### Terminology - 1-dimensional: 1 control, 1 state variable State equation: $$\dot{X} = f(X,t,u(t))\, 0 \leq t \leq T$$ $X(t)$ is the *state variable*, u(t) is the *control variable*.
" />

  <meta name="twitter:card" content="summary">
  <meta name="twitter:url" content="/archives/2012-04-09-are277-solving-for-the-optimal-path/">
  <meta name="twitter:title" content="ARE277 - Solving for the Optimal Path">
  <meta name="twitter:description" content="Thresholds / Critical Depensation in Population Dynamics -------------------------------------------------------- Mechanisms for critical depensation (Allee effect): - Mate-finding (example: Right Whales) - Demographic stochasticity (can be captured by a deterministic threshold if stochasticity is not explicit) $$\dot{X} = -r\left(1- \frac{X}{\tilde{K}}\right)\left(1- \frac{X}{K}\right)X$$ Here, $\tilde{K}$ is the threshold of zero growth. Optimal Control --------------- ### Terminology - 1-dimensional: 1 control, 1 state variable State equation: $$\dot{X} = f(X,t,u(t))\, 0 \leq t \leq T$$ $X(t)$ is the *state variable*, u(t) is the *control variable*.">
  <meta name="twitter:image" content="/assets/img/nr.png">
  <meta name="twitter:site" content="trang1618.github.io">
  <meta name="twitter:creator" content="@trang1618">

  <meta property="og:title" content="ARE277 - Solving for the Optimal Path" />
  <meta property="og:locale" content="en_US" />
  <meta property="og:site_name" content="trang1618.github.io" />
  <meta property="og:description" content="  Thresholds / Critical Depensation in Population Dynamics -------------------------------------------------------- Mechanisms for critical depensation (Allee effect): - Mate-finding (example: Right Whales) - Demographic stochasticity (can be captured by a deterministic threshold if stochasticity is not explicit) $$\dot{X} = -r\left(1- \frac{X}{\tilde{K}}\right)\left(1- \frac{X}{K}\right)X$$ Here, $\tilde{K}$ is the threshold of zero growth. Optimal Control --------------- ### Terminology - 1-dimensional: 1 control, 1 state variable State equation: $$\dot{X} = f(X,t,u(t))\, 0 \leq t \leq T$$ $X(t)$ is the *state variable*, u(t) is the *control variable*." />
  <meta property="og:url" content="/archives/2012-04-09-are277-solving-for-the-optimal-path/" />
  <script type="application/ld+json">
    {"@type":"WebSite","url":"\/archives\/2012-04-09-are277-solving-for-the-optimal-path\/","headline":"ARE277 - Solving for the Optimal Path", "name":"trang1618.github.io","description":"Thresholds \/ Critical Depensation in Population Dynamics -------------------------------------------------------- Mechanisms for critical depensation (Allee effect): - Mate-finding (example: Right Whales) - Demographic stochasticity (can be captured by a deterministic threshold if stochasticity is not explicit) $$\\dot{X} = -r\\left(1- \\frac{X}{\\tilde{K}}\\right)\\left(1- \\frac{X}{K}\\right)X$$ Here, $\\tilde{K}$ is the threshold of zero growth. Optimal Control --------------- ### Terminology - 1-dimensional: 1 control, 1 state variable State equation: $$\\dot{X} = f(X,t,u(t))\\, 0 \\leq t \\leq T$$ $X(t)$ is the *state variable*, u(t) is the *control variable*.","@context":"http://schema.org"}
  </script>

  
  
</head>

<body>

<div id="topbar" class="is-hidden-print">
	<div class="wrapper">
		<header>
			<div class="is-navbar-container">
				<nav>
				<div class="is-brand">
					<a href="/">t  r  a  n  g </a>
					<a href="#"
						 class="is-push-right-mobile is-shown-mobile icon-kube-menu"
						 data-kube="toggle"
						 data-target="#navbar-main"></a>
				</div>
				</nav>
				<div id="navbar-main" class="is-navbar is-hidden-mobile is-center-mobile">
					<nav>
						<ul>
							<li><a href="/blog">blog</a></li>
						
							<li><a href="/vitae">vitae</a></li>
							<li><a href="#connect">connect</a></li>
						</ul>
					</nav>
				</div>
			</div>
		</header>
	</div>
</div>


<div class="wrapper">
  <div class="is-row is-stack-20">
    <div class="is-col is-10">&nbsp;</div>
    <div class="is-col is-60">
    <h1 class="is-text-center"><a href="">ARE277 - Solving for the Optimal Path</a></h1>
    <h4 class="is-bigger is-text-center">April 9, 2012</h4>
    </div>
    <div class="is-col is-30">&nbsp;</div>
  </div>
  <div class="is-row is-stack-20">
  </div>
  <div class="is-row is-stack-20">
    <div class="is-col is-10 dateblock is-stack-20">
    </div>
    <div class="is-col is-60">
      <div class="story">
       


Thresholds / Critical Depensation in Population Dynamics
--------------------------------------------------------

Mechanisms for critical depensation (Allee effect):

-   Mate-finding (example: Right Whales)
-   Demographic stochasticity (can be captured by a deterministic
    threshold if stochasticity is not explicit)

$$\dot{X} = -r\left(1- \frac{X}{\tilde{K}}\right)\left(1- \frac{X}{K}\right)X$$

Here, $\tilde{K}$ is the threshold of zero growth.

Optimal Control
---------------

### Terminology

-   1-dimensional: 1 control, 1 state variable

State equation:

$$\dot{X} = f(X,t,u(t))\, 0 \leq t \leq T$$

$X(t)$ is the *state variable*, u(t) is the *control variable*. The
equation gives us the path over time, and we use *u* to manipulate that
path. $T$ is the terminal time, but it can be $\infty$.

In some cases, there will be a *terminal condition*, or boundary
condition, e.g., $X(T) = X_T$.

A feasible control $u(t) \subseteq U(t)$ such that $X_t$ satisfies
$(X_0,\, X_t)$, where $U(t)$ is closed and bounded.

The objective Functional:

$$J\{u\} = \int_0^T g(x(t), t, u(t))\, dt$$

*Aside: a Functional is a function of a function, as in
$F_{a,b}\{f\}=\int_a^b f(x)^2\,dx$*

$g(\cdot)$ is a given, continuously differentiable function. For
instance, it could be the profit function.

The goal of optimal control is to find $u(t)$ that maximizes $J\{u\}$
such that it satisfies the boundary conditions and the state equation.

The *Pontraygin conditions* give the necessary conditions that must be
satisfied for $u(t)$ to exist.

$$J\{u\} = \max_{u(x)} \int_0^T g(\cdot) \, dt, \text { s.t. } \dot{X} = f(\cdot), \, X_0, X_T$$

Necessary conditions:

-   The Hamiltonian ($H$), which is the dynamic equivalent of the
    Lagrange,

    $$H = g(x,t,u(t)) + \lambda(t)(f(x(t),t(u(t)))$$

    $$H = \text{profits summed over time} + \lambda[\text{stock over time}]$$

-   The adjoint ($\lambda$) equation:

    $$ \frac{d\lambda}{dt} = -\frac{dH}{dx} = -\frac{\partial g}{\partial x} + \lambda(t) \frac{\partial f}{\partial x}$$

    $$ \max_{u(t) \subseteq U(t)} H \Rightarrow \frac{dH}{du} = 0$$

-   A differentiable state function

    $$\frac{dx}{dt}=f(\cdot)$$

-   Boundary conditions

    $$X_0, X_t, x(t) \geq 0$$

For multivariable problems, we just use vectors for each of the state
variables.

### Example: A Non-linear Fishery

Here our control is the harvest function $h(t)$, and $g(\cdot)$ is the
time-discounted profit function.

$$\max_{h_t} \int_0^T e^{-rt} \Pi h(t)\,dt$$

$$\dot{X}_t = F(X_t) - h_t$$

$F(X_t)$ is logistic. Also, profit is a positive, concave function of
harvest:

$$\Pi_h \geq 0,\, \Pi_{hh} \leq 0$$

Our Hamiltonian is:

$$H = e^{-rt} \Pi(h(t)) + \lambda [F(X_t) - h_t]$$

<div style="border:1px solid #ccc; padding:20px;">

#### Aside: Dimensionality

$$\dot{X}_t = F(X(t)) - h(t)$$

$$\frac{\text{biomass}}{\text{time}} = F(X_t) - \frac{\text{biomass}}{\text{time}}$$

$$F(X_t) = \delta X_t\left(1 - \frac{X_t}{K}\right)$$

$$\delta = \frac{1}{\text{time}}$$

This means that $\Pi_{hh} \leq 0$ means that there is a penalty, or
*adjustment cost* for changing $h$ too fast.

$\lambda_t$ is in dollars per unit biomass - it is a shadow price.

</div>

*Back to the problem:*

2.  Determine the conditions:

    A.
    $$\frac{d\lambda_t}{dt} = -\frac{dH}{dX} = -\lambda_t \frac{dF}{dX_t}$$
    B. The K-T Condition:
    $$h_t \frac{dH}{dt} = 0 = \left( e^{-rt} \Pi_{h_t} - \lambda_t \right) h_t$$\
    C. $$\frac{dX_t}{dt} = F(x_t) - h(t)$$

Assume $h^* \neq 0$

$$e^{-rt} \Pi_{h_t} - \lambda_t = 0$$

$$\dot{\lambda}_t = \lambda_t \frac{dF}{dX_t}$$

$$\dot{X}_t = F(x) - h{t}$$

Eliminate $\lambda$. Differentiate the first equation, using the chain
rule, and set equal to the second:

$$\frac{d\lambda}{dt} = -re^{-rt} \Pi_{h_t} + e^{-rt} [\dot{h} \Pi_{hh}] \Rightarrow$$

$$-r \Pi_{ht} + \dot{h} \Pi_{hh} = -\Pi_{h_t} \frac{dF}{dX_t}$$

$$\dot{h} = \frac{\Pi_{h_t}}{\Pi_{hh}} \left[ r - \frac{dF}{dX_t} \right]$$

$$\dot{X} = F(X_t) - h(t)$$

Boundary equations $(X_0, X_T)$. Note that the boundary conditions are
only for the biomass, not the harvest. If you get $(X_0, h_0)$, then you
can solve this as a set of normal ODEs.

### Stability / Phase Diagrams

The phase diagram should describe *all* qualitative solutions. Now the
diagram gives us the *optimal* path - the optimal $h$ and associated
$X$. We

$$\dot{h} = \frac{\Pi_{h_t}}{\Pi_{hh}} \left[ r - \frac{dF}{dX_t} \right]$$

$$\dot{X} = F(X_t) - h(t)$$

We derive the nullclines and plot:

$$h(t) = F(X_t)$$

For $\dot{h} = 0$, $r = \frac{dF}{dX_t}$

![image](/assets/old-blog-stuff/optphase.png)

Now, with $X_0$, you need $X_T$ to determine what that harvest path and
$h_0$ are. For $T=\infty$, we want to get onto one of the saddle paths
that leads to the saddle node.

#### Linearizing

$$ \begin{bmatrix} \dot{h} \\ \dot{X} \end{bmatrix} = \begin{bmatrix} \frac{d \dot{h}}{dh} && \frac{d \dot{h}}{dX} \\ \frac{d \dot{X}}{dh} && \frac{d\dot{X}}{dX}     \end{bmatrix} \begin{bmatrix} h^* - h^{ss} \\ x^* - x^{ss} \end{bmatrix} $$

$$\begin{bmatrix} \frac{d\dot{h}}{dh} = r - F'(X) - \frac{\Pi_h}{\Pi_{hh}}[r - F'(x)]   && \frac{d\dot{X}}{dh} = -1 \\ \frac{d\dot{h}}{dX} = \frac{\Pi_h}{\Pi_{hh}} F_{XX} &&\frac{d\dot{X}}{dX} = F_X \end{bmatrix}$$

Note that stability is determined by the determinant *and* the trace of
the Jacobian matrix:

![Relationship between the Jacobian and stability, from
](/assets/old-blog-stuff/QuickShot%202012-04-09%20at%2013.43.08.jpg)

As the time horizon increases, the longer one spends near the
equilibrium. (Known as the Catenery Turnpike theorem - Paul Samuelson
(1965)) Note that, due to discounting, a long-term horizon is equivalent
to an infinite one.

Finding the optimal path is a numeric problem - using a "shooting
algorithm" of adjusting $h_0$ until our $X_T$ comes out correctly.

#### Transversality

*Transversality* conditions are boundary conditions if there is no
$X_T$. This is driven by the shadow price at $T$, which should be zero:

$$\lambda(T) \equiv \lambda_t = 0$$

$$e^{-rt} \Pi_{h_t} - \lambda_t = 0$$

$$e^{-rT} \Pi_{h_t} = \lambda_t $$

$$\Pi_{h_t} = 0$$

In this case, the conditions correspond to the point of no profit in the
fishery.

Edelstein-Keshet, L. 1988. Mathematical Models in Biology. McGraw-Hill.

      </div>
      <hr>
      
      <a href="/archives/2012-04-04-are277-guest-lecture-from-jim-wilen/"> &larr;&nbsp;ARE277: Guest Lecture from Jim Wilen</a> |
      
      <a href="//blog/#2012">All posts</a>
      
      | <a href="/archives/2012-04-11-are277-transversality-and-linear-optimal-control/">ARE277 - Transversality and Linear Optimal Control&nbsp;&rarr;</a>
      
    </div>
    <div class="is-col is-30"></div>

  </div>
</div>



<footer id="footer" class="is-hidden-print">
  <div class="wrapper">
    <div class="is-row .is-small is-muted">
      <div class="is-col is-33">
        <h3>About</h3>
        <em>
          <p>This is my personal website. Nothing here is endorsed by my employer or organizations I am part of.</p>
          <p>Content on this site is released under a
            <a href="https://creativecommons.org/licenses/by/4.0/legalcode">CC-BY 4.0 license.</a>
            Source code of the site is provided under the <a href="https://opensource.org/licenses/MIT">MIT license</a>
            and may be reused without restriction.</p>
          <p>Huge thanks to Noam Ross for the beautifully designed website and detailed instruction on how to built it <a href="https://www.noamross.net/2019/08/09/a-new-website/">here</a>.</p>
        </em>
      </div>
      <div class="is-col is-33">
        <h3 id="connect">Connect</h3>
        <ul class="fa-ul">
          <li><i class="fa-li fas fa-briefcase fa-fw"></i>3700 Hamilton Walk, Philadelphia, PA 19104</li>
          <li><i class="fa-li fas fa-envelope fa-fw"></i><a href="mailto:grixor@gmail.com">grixor@gmail.com</a></li>
          <li><a href="https://orcid.org/0000-0003-3737-6565"><i class="fa-li ai ai-orcid"></i></a><a href="https://orcid.org/0000-0003-3737-6565">0000-0003-3737-6565</a></li>
          <li><a href="https://scholar.google.com/citations?user=OMpJVfsAAAAJ&hl=en"><i class="fa-li ai ai-google-scholar"></i></a><a href="https://scholar.google.com/citations?user=OMpJVfsAAAAJ">Google Scholar</a></li>
          <li><a href="https://twitter.com/trang1618"><i class="fa-li fab fa-twitter fa-fw"></i></a><a href="https://twitter.com/trang1618">@trang1618</a></li>
          <li><a href="https://github.com/trang1618"><i class="fa-li fab fa-github fa-fw"></i></a><a href="https://github.com/trang1618">github.com/trang1618</a>
          <li><a href="https://slides.com/trang1618"><i class="fa-li fas fa-object-ungroup fa-fw"></i></a><a href="https://slides.com/trang1618">slides.com/trang1618</a>
        </ul>
      </div>
      <div class="is-col is-33">
        <h3 id="subscribe">Subscribe</h3>
        <em><p>Follow me on Twitter at <a href="https://twitter.com/trang1618">@trang1618</a> where I'll update you if anything is posted.</p></em>
        <h3 id="search">Search</h3>
        <nav class="is-push-right is-left-mobile" class="is-hidden-mobile">
					<form method="get" action="https://duckduckgo.com/">
      <input type="search" name="q" maxlength="255" placeholder="Search on site">
      <input type="hidden" name="sites" value="www.trang1618.github.io" />
      <input type="hidden" name="ka" value="Alegreya" />
      <input type="hidden" name="k7" value="#faf8f8" />
      <input type="hidden" name="kj" value="#b33" />
      <input type="hidden" name="ky" value="#fafafa" />
      <input type="hidden" name="kx" value="b" />
      <input type="hidden" name="ko" value="-1" />
      <input type="hidden" name="k1" value="-1" />
      <input type="hidden" name="kt" value="Alegreya Sans" />
</form>
				</nav>
      </div>
    </div>
  </div>
</footer>

<script type="text/javascript" src="/assets/js/kube.js"></script>
<script>
  $K.dom(window).on('load', $K.init);
</script>


</body>
</html>
