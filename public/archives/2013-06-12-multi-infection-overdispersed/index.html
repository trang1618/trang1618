
<!DOCTYPE html>
<html>


<head>

  <link href="https://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The null model for age effects with overdispersed infection</title>
  <link rel="canonical" href="/archives/2013-06-12-multi-infection-overdispersed/" />

  
  <link rel="stylesheet" href="/assets/css/kube.css" />
  <link rel="stylesheet" href="/assets/css/custom.css" />
  <link rel="stylesheet" href="/assets/css/tufte.css" />

  
  <link href='https://fonts.googleapis.com/css?family=Alegreya:400italic,400,700,700italic&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Alegreya+SC:400&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
  <link href="https://fonts.googleapis.com/css?family=IM+Fell+English:400,400i&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=IM+Fell+English+SC&display=swap" rel="stylesheet">
  <link href="/assets/fonts/fell-flowers/style.css" rel="stylesheet" type="text/css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hack-font@3/build/web/hack-subset.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.0/css/academicons.min.css">
  <link href="/assets/fonts/fontawesome/css/all.css" rel="stylesheet">
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png">
  <link rel="shortcut icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png">
  <link rel="manifest" href="/assets/site.webmanifest">
  <link rel="mask-icon" href="/assets/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#2b5797">
  <meta name="theme-color" content="#ffffff">

  
  

  
  <meta name="description" content="How does overdispersion of infections affect the behavior of the [multiple-infection model](http://www.noamross.net/blog/2013/6/11/multi-infection-tests.html)? I redefine the model to account for overdispersion, assuming the same overdispersion occurs in both age classes. The parameter $k$ varies inversely with the degree of overdispersion. Again, the classes are demographically identical, and infection affects mortality but not growth: $$\begin{aligned} \frac{dJ}{dt} &= A f_A \left(1 - \frac{J&#43;A}{K} \right) &#43; J \left(f_J \left(1 - \frac{J&#43;A}{K} \right) - d_J - g\right) - \alpha P_J \\ \frac{dA}{dt} &= J g - A d_A - \alpha P_A \\ \frac{dP_J}{dt} &= \lambda \frac{J}{K} (P_J &#43; P_A) - P_J \left(d_J &#43; \mu &#43; g &#43; \alpha \left(1 &#43; \frac{(k&#43;1)P_J}{kJ} \right) \right) \\ \frac{dP_A}{dt} &= \lambda \frac{J}{K} (P_J &#43; P_A) &#43; P_J g - PA \left(d_A &#43; \mu &#43; \alpha \left(1 &#43; \frac{(k&#43;1)P_A}{kA} \right) \right) \end{aligned}$$ I define the model and run it in R below, using values of $k$ ranging from 0.
" />

  <meta name="twitter:card" content="summary">
  <meta name="twitter:url" content="/archives/2013-06-12-multi-infection-overdispersed/">
  <meta name="twitter:title" content="The null model for age effects with overdispersed infection">
  <meta name="twitter:description" content="How does overdispersion of infections affect the behavior of the [multiple-infection model](http://www.noamross.net/blog/2013/6/11/multi-infection-tests.html)? I redefine the model to account for overdispersion, assuming the same overdispersion occurs in both age classes. The parameter $k$ varies inversely with the degree of overdispersion. Again, the classes are demographically identical, and infection affects mortality but not growth: $$\begin{aligned} \frac{dJ}{dt} &= A f_A \left(1 - \frac{J&#43;A}{K} \right) &#43; J \left(f_J \left(1 - \frac{J&#43;A}{K} \right) - d_J - g\right) - \alpha P_J \\ \frac{dA}{dt} &= J g - A d_A - \alpha P_A \\ \frac{dP_J}{dt} &= \lambda \frac{J}{K} (P_J &#43; P_A) - P_J \left(d_J &#43; \mu &#43; g &#43; \alpha \left(1 &#43; \frac{(k&#43;1)P_J}{kJ} \right) \right) \\ \frac{dP_A}{dt} &= \lambda \frac{J}{K} (P_J &#43; P_A) &#43; P_J g - PA \left(d_A &#43; \mu &#43; \alpha \left(1 &#43; \frac{(k&#43;1)P_A}{kA} \right) \right) \end{aligned}$$ I define the model and run it in R below, using values of $k$ ranging from 0.">
  <meta name="twitter:image" content="/assets/img/nr.png">
  <meta name="twitter:site" content="trang1618.github.io">
  <meta name="twitter:creator" content="@trang1618">

  <meta property="og:title" content="The null model for age effects with overdispersed infection" />
  <meta property="og:locale" content="en_US" />
  <meta property="og:site_name" content="trang1618.github.io" />
  <meta property="og:description" content="  How does overdispersion of infections affect the behavior of the [multiple-infection model](http://www.noamross.net/blog/2013/6/11/multi-infection-tests.html)? I redefine the model to account for overdispersion, assuming the same overdispersion occurs in both age classes. The parameter $k$ varies inversely with the degree of overdispersion. Again, the classes are demographically identical, and infection affects mortality but not growth: $$\begin{aligned} \frac{dJ}{dt} &= A f_A \left(1 - \frac{J&#43;A}{K} \right) &#43; J \left(f_J \left(1 - \frac{J&#43;A}{K} \right) - d_J - g\right) - \alpha P_J \\ \frac{dA}{dt} &= J g - A d_A - \alpha P_A \\ \frac{dP_J}{dt} &= \lambda \frac{J}{K} (P_J &#43; P_A) - P_J \left(d_J &#43; \mu &#43; g &#43; \alpha \left(1 &#43; \frac{(k&#43;1)P_J}{kJ} \right) \right) \\ \frac{dP_A}{dt} &= \lambda \frac{J}{K} (P_J &#43; P_A) &#43; P_J g - PA \left(d_A &#43; \mu &#43; \alpha \left(1 &#43; \frac{(k&#43;1)P_A}{kA} \right) \right) \end{aligned}$$ I define the model and run it in R below, using values of $k$ ranging from 0." />
  <meta property="og:url" content="/archives/2013-06-12-multi-infection-overdispersed/" />
  <script type="application/ld+json">
    {"@type":"WebSite","url":"\/archives\/2013-06-12-multi-infection-overdispersed\/","headline":"The null model for age effects with overdispersed infection", "name":"trang1618.github.io","description":"How does overdispersion of infections affect the behavior of the [multiple-infection model](http:\/\/www.noamross.net\/blog\/2013\/6\/11\/multi-infection-tests.html)? I redefine the model to account for overdispersion, assuming the same overdispersion occurs in both age classes. The parameter $k$ varies inversely with the degree of overdispersion. Again, the classes are demographically identical, and infection affects mortality but not growth: $$\\begin{aligned} \\frac{dJ}{dt} \x26= A f_A \\left(1 - \\frac{J\x2bA}{K} \\right) \x2b J \\left(f_J \\left(1 - \\frac{J\x2bA}{K} \\right) - d_J - g\\right) - \\alpha P_J \\\\ \\frac{dA}{dt} \x26= J g - A d_A - \\alpha P_A \\\\ \\frac{dP_J}{dt} \x26= \\lambda \\frac{J}{K} (P_J \x2b P_A) - P_J \\left(d_J \x2b \\mu \x2b g \x2b \\alpha \\left(1 \x2b \\frac{(k\x2b1)P_J}{kJ} \\right) \\right) \\\\ \\frac{dP_A}{dt} \x26= \\lambda \\frac{J}{K} (P_J \x2b P_A) \x2b P_J g - PA \\left(d_A \x2b \\mu \x2b \\alpha \\left(1 \x2b \\frac{(k\x2b1)P_A}{kA} \\right) \\right) \\end{aligned}$$ I define the model and run it in R below, using values of $k$ ranging from 0.","@context":"http://schema.org"}
  </script>

  
  
</head>

<body>

<div id="topbar" class="is-hidden-print">
	<div class="wrapper">
		<header>
			<div class="is-navbar-container">
				<nav>
				<div class="is-brand">
					<a href="/">t  r  a  n  g </a>
					<a href="#"
						 class="is-push-right-mobile is-shown-mobile icon-kube-menu"
						 data-kube="toggle"
						 data-target="#navbar-main"></a>
				</div>
				</nav>
				<div id="navbar-main" class="is-navbar is-hidden-mobile is-center-mobile">
					<nav>
						<ul>
							<li><a href="/blog">blog</a></li>
						
							<li><a href="/vitae">vitae</a></li>
							<li><a href="#connect">connect</a></li>
						</ul>
					</nav>
				</div>
			</div>
		</header>
	</div>
</div>


<div class="wrapper">
  <div class="is-row is-stack-20">
    <div class="is-col is-10">&nbsp;</div>
    <div class="is-col is-60">
    <h1 class="is-text-center"><a href="">The null model for age effects with overdispersed infection</a></h1>
    <h4 class="is-bigger is-text-center">June 12, 2013</h4>
    </div>
    <div class="is-col is-30">&nbsp;</div>
  </div>
  <div class="is-row is-stack-20">
  </div>
  <div class="is-row is-stack-20">
    <div class="is-col is-10 dateblock is-stack-20">
    </div>
    <div class="is-col is-60">
      <div class="story">
       


How does overdispersion of infections affect the behavior of the
[multiple-infection
model](http://www.noamross.net/blog/2013/6/11/multi-infection-tests.html)?
I redefine the model to account for overdispersion, assuming the same
overdispersion occurs in both age classes. The parameter $k$ varies
inversely with the degree of overdispersion. Again, the classes are
demographically identical, and infection affects mortality but not
growth:

$$\begin{aligned}
  \frac{dJ}{dt}  &= A f_A \left(1 - \frac{J+A}{K} \right) + J  \left(f_J \left(1 - \frac{J+A}{K} \right) - d_J - g\right) - \alpha P_J \\
  \frac{dA}{dt}  &= J g - A d_A - \alpha P_A \\
  \frac{dP_J}{dt}  &= \lambda  \frac{J}{K} (P_J + P_A)  - P_J \left(d_J + \mu + g + \alpha \left(1 + \frac{(k+1)P_J}{kJ} \right) \right) \\
  \frac{dP_A}{dt}  &= \lambda  \frac{J}{K} (P_J + P_A)  + P_J  g - PA \left(d_A + \mu + \alpha \left(1 + \frac{(k+1)P_A}{kA}  \right) \right)
\end{aligned}$$

I define the model and run it in R below, using values of $k$ ranging
from 0.01 to 10. Otherwise all parameters and conditions are the same as
in my [last
post](http://www.noamross.net/blog/2013/6/11/multi-infection-tests.html).

~~~~ {.r}
od.model <- function(t, y, parms) {
  list2env(as.list(y), environment())
  list2env(as.list(parms), environment())
  dJ <- A*f_a*(1 - (J+A)/K) + J * (f_j*(1 - (J+A)/K) - d_j - g) - alpha * PJ
  dA <- J*g - (A * d_a) - alpha * PA
  dPJ <- lambda * (PJ + PA) * J/K - 
         PJ*(d_j + mu + g + alpha*(1 + (k+1)*PJ/(k*J)))
  dPA <- lambda * (PJ + PA) * A/K + PJ * g - 
         PA*(d_a + mu + alpha*(1 + (k+1)*PA/(k*A)))
  return(list(c(dJ=dJ, dA=dA, dPJ=dPJ, dPA=dPA), 
              c(dJ=dJ, dA=dA, dPJ=dPJ, dPA=dPA)))
}

parms <- c( 
  f_j=0.01,
  f_a=0.01,
  g=0.1,
  d_j=0.005,
  d_a=0.005,
  alpha=0.05,
  lambda=0.3,
  K=50,
  mu=0.00,
  k=0.000
  )

A_ss = with(as.list(parms), K/(d_a/g + 1))
J_ss = with(as.list(parms), K - A_ss)
init <- c(J=J_ss, A=A_ss, PJ=0.1*J_ss, PA=0.1*A_ss)

require(deSolve)
require(reshape2)
require(plyr)
ks <- c(10, 1, 0.1, 0.01)
df <- adply(ks, 1, function(x) {
  parms["k"] <- x
  df <- data.frame(k.val=as.factor(x), 
                   as.data.frame(lsoda(y=init, times=1:100, func=od.model, 
                                       parms=parms)))
  })

names(df)[names(df)=="time"] <- "Time"
df$X1 <- NULL

df <- within(df, {
  list2env(as.list(parms), environment())
  pctJ <- J/(J + A)
  pctA <- A/(J + A)
  nJ <- PJ / J
  nA <- PA / A
  J.inf <- 1 - exp(-nJ)
  A.inf <- 1 - exp(-nA)
  Inf.dens <- (J*J.inf + A*A.inf)
  J.mort <- d_j + alpha * PJ / (J *J.inf)
  A.mort <- d_a + alpha * PA / (A * A.inf)
  J.yrs <- 1/J.mort
  A.yrs <- 1/A.mort
  J.infrate <- 1 - exp(-lambda * (PJ + PA) * J * exp(-PJ/J) / K)
  A.infrate <- 1 - exp(-lambda * (PJ + PA) * A * exp(-PA/A) / K)
  J.infyrs <- 1/J.infrate
  A.infyrs <- 1/A.infrate
  rm(list=names(parms))
})

df <- df[,sort(names(df), decreasing=TRUE)]

mdf <- melt(df, id.vars=c("Time", "Inf.dens", "k.val"), variable.name="Class",
            value.name="Population")
~~~~

Now I plot the results. In all of the following the darker lines
represent the case with more overdispersion, and the lighter case are
closer to random distribution of infections.

~~~~ {.r}
require(ggplot2)
require(gridExtra)
theme_nr <- theme_nr + theme(legend.title=element_text(size=22),
                             legend.text=element_text(size=16),
                             legend.key.size=unit(.75, "cm"))
JAlab <- scale_color_discrete(labels=c("Small Trees","Big Trees"), name="") 
p1 <- ggplot(subset(mdf, Class %in% c("J", "A")), 
             aes(x=Time, y=Population, col=Class, alpha=k.val)) + 
      geom_line(lwd=1) + theme_nr + ylab("Population") + JAlab
p2 <- ggplot(subset(mdf, Class %in% c("pctJ", "pctA")), 
             aes(x=Time, y=Population, col=Class, alpha=k.val)) + 
      geom_line(lwd=1) + theme_nr + ylab("Fraction of Population") + JAlab
grid.arrange(p1, p2, nrow=2)
~~~~

![](/assets/old-blog-stuff/multi-infection-overdispersed-unnamed-chunk-2.png)

In general, overdispersion appears to reduce the decline of the
population. This is because fewer, more heavily infected individuals
carry more of the infections in the population, and take those away when
they die. I wonder how biologically realistic is this in the case of
SOD? Now I look at infection rates:

~~~~ {.r}
p3 <- ggplot(subset(mdf, Class %in% c("PJ", "PA")),
             aes(x=Time, y=Population, col=Class, alpha=k.val)) +
      geom_line(lwd=1) + theme_nr + ylab("Number of Infections") + JAlab
p4 <- ggplot(subset(mdf, Class %in% c("nJ", "nA")),
             aes(x=Time, y=Population, col=Class, alpha=k.val)) +
      geom_line(lwd=1) + theme_nr + ylab("Infections per Individual") + JAlab
grid.arrange(p3, p4, nrow=2)
~~~~

![](/assets/old-blog-stuff/multi-infection-overdispersed-unnamed-chunk-3.png)

As you can see, the overall infections rate are lower in the case of
overdispersion.

~~~~ {.r}
ggplot(subset(mdf, Class %in% c("J.inf", "A.inf")), 
       aes(x=Time, y=Population, col=Class, alpha=k.val)) + 
geom_line(lwd=1) + theme_nr + ylab("Fraction infected") + JAlab
~~~~

![](/assets/old-blog-stuff/multi-infection-overdispersed-unnamed-chunk-4.png)

The fraction of the population infected when there is some
overdispersion is more in line with what is seen in the field in many
cases.

~~~~ {.r}
ggplot(subset(mdf, Class %in% c("J.yrs", "A.yrs") ), 
       aes(x=Inf.dens, y=Population, col=Class, alpha=k.val)) + 
  geom_point(cex=4) + theme_nr + xlab("Number of infected trees") + 
  ylab("Years to death of infected individuals") + JAlab
~~~~

![](/assets/old-blog-stuff/multi-infection-overdispersed-unnamed-chunk-5.png)

With less infection, there's less of a dramatic difference between the
upswing and downswing of the disease, but the relationship between
infected trees and years-to-death still holds.

In general, overdispersion seems to dampen the effects of infection, but
most qualitative patterns remain.

In some ways, overdispersal has a similar effect to space in the Cobb et
al. (2012) $SIR$ model. Spatial structure, of course, is one mechanism
that can create overdispersal.

Cobb, R. C., J. A. N. Filipe, R. K. Meentemeyer, C. A. Gilligan, and D.
M. Rizzo. 2012. Ecosystem transformation by emerging infectious disease:
loss of large tanoak from California forests. Journal of Ecology
100:712–722.

      </div>
      <hr>
      
      <a href="/archives/2013-06-11-multi-infection-tests/"> &larr;&nbsp;A Null Model for Age Effects in Disease with Multiple Infections</a> |
      
      <a href="//blog/#2013">All posts</a>
      
      | <a href="/archives/2013-06-17-harrisbbmle/">Dave Harris on Maximum Likelihood Estimation&nbsp;&rarr;</a>
      
    </div>
    <div class="is-col is-30"></div>

  </div>
</div>



<footer id="footer" class="is-hidden-print">
  <div class="wrapper">
    <div class="is-row .is-small is-muted">
      <div class="is-col is-33">
        <h3>About</h3>
        <em>
          <p>This is my personal website. Nothing here is endorsed by my employer or organizations I am part of.</p>
          <p>Content on this site is released under a
            <a href="https://creativecommons.org/licenses/by/4.0/legalcode">CC-BY 4.0 license.</a>
            Source code of the site is provided under the <a href="https://opensource.org/licenses/MIT">MIT license</a>
            and may be reused without restriction.</p>
          <p>Huge thanks to Noam Ross for the beautifully designed website and detailed instruction on how to built it <a href="https://www.noamross.net/2019/08/09/a-new-website/">here</a>.</p>
        </em>
      </div>
      <div class="is-col is-33">
        <h3 id="connect">Connect</h3>
        <ul class="fa-ul">
          <li><i class="fa-li fas fa-briefcase fa-fw"></i>3700 Hamilton Walk, Philadelphia, PA 19104</li>
          <li><i class="fa-li fas fa-envelope fa-fw"></i><a href="mailto:grixor@gmail.com">grixor@gmail.com</a></li>
          <li><a href="https://orcid.org/0000-0003-3737-6565"><i class="fa-li ai ai-orcid"></i></a><a href="https://orcid.org/0000-0003-3737-6565">0000-0003-3737-6565</a></li>
          <li><a href="https://scholar.google.com/citations?user=OMpJVfsAAAAJ&hl=en"><i class="fa-li ai ai-google-scholar"></i></a><a href="https://scholar.google.com/citations?user=OMpJVfsAAAAJ">Google Scholar</a></li>
          <li><a href="https://twitter.com/trang1618"><i class="fa-li fab fa-twitter fa-fw"></i></a><a href="https://twitter.com/trang1618">@trang1618</a></li>
          <li><a href="https://github.com/trang1618"><i class="fa-li fab fa-github fa-fw"></i></a><a href="https://github.com/trang1618">github.com/trang1618</a>
          <li><a href="https://slides.com/trang1618"><i class="fa-li fas fa-object-ungroup fa-fw"></i></a><a href="https://slides.com/trang1618">slides.com/trang1618</a>
        </ul>
      </div>
      <div class="is-col is-33">
        <h3 id="subscribe">Subscribe</h3>
        <em><p>Follow me on Twitter at <a href="https://twitter.com/trang1618">@trang1618</a> where I'll update you if anything is posted.</p></em>
        <h3 id="search">Search</h3>
        <nav class="is-push-right is-left-mobile" class="is-hidden-mobile">
					<form method="get" action="https://duckduckgo.com/">
      <input type="search" name="q" maxlength="255" placeholder="Search on site">
      <input type="hidden" name="sites" value="www.trang1618.github.io" />
      <input type="hidden" name="ka" value="Alegreya" />
      <input type="hidden" name="k7" value="#faf8f8" />
      <input type="hidden" name="kj" value="#b33" />
      <input type="hidden" name="ky" value="#fafafa" />
      <input type="hidden" name="kx" value="b" />
      <input type="hidden" name="ko" value="-1" />
      <input type="hidden" name="k1" value="-1" />
      <input type="hidden" name="kt" value="Alegreya Sans" />
</form>
				</nav>
      </div>
    </div>
  </div>
</footer>

<script type="text/javascript" src="/assets/js/kube.js"></script>
<script>
  $K.dom(window).on('load', $K.init);
</script>


</body>
</html>
